(self.webpackChunkparami_app=self.webpackChunkparami_app||[]).push([[2627],{19273:function(m,v,e){"use strict";e.d(v,{Z:function(){return B}});function B(f){if(f==null)throw new TypeError("Cannot destructure undefined")}},55133:function(m){m.exports={modal:"modal___1O81X",codeInput:"codeInput___1b6is",verifyForm:"verifyForm___3o9Cw",highLight:"highLight___wTtyW",verifyInput:"verifyInput___29jF0",buttons:"buttons___2s-8l",button:"button___13mjZ",title:"title___35CCk",confirmContainer:"confirmContainer___3-95Y",alertContainer:"alertContainer___HBKri",field:"field___mBf3w",labal:"labal___1ZC5A",small:"small___1qvTc",labalIcon:"labalIcon___Wx-BW",value:"value___16uzM"}},31639:function(m){m.exports={ad3:"ad3___22MgQ",unit:"unit___UR_Yf"}},55248:function(m){m.exports={container:"container___rtU1m"}},69764:function(m,v,e){"use strict";var B=e(71194),f=e(50146),R=e(57663),M=e(71577),K=e(402),o=e(3887),F=e(67294),b=e(55133),D=e.n(b),j=e(54549),y=e(85893),Y=o.Z.Title,$=function(O){var H=O.visable,d=O.title,p=O.content,T=O.footer,U=O.close,J=O.bodyStyle,t=O.width;return(0,y.jsx)(f.Z,{title:d?(0,y.jsx)(Y,{level:5,className:D().title,children:d}):null,closable:!!U,closeIcon:(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(M.Z,{shape:"circle",size:"middle",type:"ghost",icon:(0,y.jsx)(j.Z,{onClick:U})})}),className:D().modal,centered:!0,visible:H,width:t!=null?t:650,footer:T,bodyStyle:J,children:p})};v.Z=$},46656:function(m,v,e){"use strict";var B=e(71194),f=e(50146),R=e(47673),M=e(32787),K=e(22385),o=e(31097),F=e(17462),b=e(76772),D=e(57663),j=e(71577),y=e(74379),Y=e(38648),$=e(3182),V=e(2824),O=e(402),H=e(3887),d=e(94043),p=e.n(d),T=e(67294),U=e(43581),J=e(55133),t=e.n(J),ne=e(3548),re=e(68855),ie=e(47832),w=e(43955),oe=e(51625),l=e(85893),de=H.Z.Title,q=function(I){var A=I.visable,h=I.setVisable,s=I.passphrase,S=I.setPassphrase,k=I.func,P=I.changePassphrase,ee=I.directSubmit,G=ee===void 0?!1:ee,z=(0,U.tT)("apiWs"),g=(0,U.tT)("currentUser"),a=g.wallet,ce=(0,U.tT)("balance"),se=ce.balance,ae=(0,T.useState)(!1),te=(0,V.Z)(ae,2),Q=te[0],Z=te[1],le=(0,T.useState)(),_e=(0,V.Z)(le,2),L=_e[0],ve=_e[1],C=(0,U.YB)(),W=function(c){S(c?c.target.value:"")},E=function(){var u=(0,$.Z)(p().mark(function c(){var n,x,r,X,Ee;return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(Z(!0),a!=null&&a.passphrase&&S(a==null?void 0:a.passphrase),!((!s||s.length<6)&&!(a!=null&&a.passphrase))){i.next=5;break}return Z(!1),i.abrupt("return");case 5:if(n=(a==null?void 0:a.passphrase)||s,!(n&&a!==null&&a!==void 0&&a.keystore)){i.next=16;break}if(x=(0,ie.Gh)(n,a.keystore),x){i.next=13;break}return Y.default.error({key:"passphraseError",message:C.formatMessage({id:"error.passphrase.error"}),duration:null}),S(""),Z(!1),i.abrupt("return");case 13:r=new w.ZP({type:"sr25519"}),X=r.addFromUri(x),Ee=X.address,a!=null&&a.account&&a.account!==Ee&&(localStorage.clear(),sessionStorage.clear(),window.location.href=oe.Z.page.homePage);case 16:if(!k){i.next=25;break}return i.prev=17,i.next=20,k();case 20:i.next=25;break;case 22:i.prev=22,i.t0=i.catch(17),console.log("security modal submit func error fallback",i.t0);case 25:h(!1),Z(!1);case 27:case"end":return i.stop()}},c,null,[[17,22]])}));return function(){return u.apply(this,arguments)}}(),N=function(){var u=(0,$.Z)(p().mark(function c(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(!!z&&!!a.account)){r.next=11;break}return r.next=3,k(!0,a.account);case 3:if(n=r.sent,!n){r.next=8;break}ve(n.partialFee),r.next=11;break;case 8:if(P){r.next=11;break}return r.next=11,E();case 11:case"end":return r.stop()}},c)}));return function(){return u.apply(this,arguments)}}();return(0,T.useEffect)(function(){!!z&&!!(a!=null&&a.account)&&A&&!G&&N()},[z,a==null?void 0:a.account,A,G]),(0,T.useEffect)(function(){!!(a!=null&&a.passphrase)&&A&&!P&&S(a==null?void 0:a.passphrase)},[a==null?void 0:a.passphrase,s,A,P]),(0,T.useEffect)(function(){s&&A&&G&&E()},[s,A,G]),(0,l.jsxs)(f.Z,{title:(0,l.jsx)(de,{level:3,children:C.formatMessage({id:"modal.security.title"})}),closable:!1,className:t().modal,centered:!0,visible:A,width:400,footer:(0,l.jsxs)("div",{className:t().buttons,children:[(0,l.jsx)(j.Z,{type:"text",shape:"round",size:"large",className:t().button,onClick:function(){h(!1),window.location.reload()},loading:Q,children:C.formatMessage({id:"common.decline"})}),(0,l.jsx)(j.Z,{type:"primary",shape:"round",size:"large",className:t().button,onClick:function(){E()},disabled:!s||s.length<6,loading:Q,children:C.formatMessage({id:"common.confirm"})})]}),children:[(0,l.jsxs)("div",{className:t().confirmContainer,children:[!!L&&!!(L!=null&&L.toString())>se.free&&(0,l.jsx)(b.Z,{description:C.formatMessage({id:"error.balance.low"}),type:"warning",showIcon:!0,banner:!0,className:t().alertContainer}),!!L&&(0,l.jsxs)("div",{className:t().field,children:[(0,l.jsxs)("div",{className:t().labal,children:[C.formatMessage({id:"modal.security.gas"}),(0,l.jsxs)("span",{className:t().small,children:["(",C.formatMessage({id:"modal.security.estimated"}),")"]}),(0,l.jsx)(o.Z,{placement:"bottom",title:C.formatMessage({id:"modal.security.gas.tooltip",defaultMessage:"Gas fees are paid to crypto miners who process transactions on the network. Parami does not profit from gas fees."}),children:(0,l.jsx)(re.Z,{className:t().labalIcon})})]}),(0,l.jsx)("div",{className:t().value,children:(0,l.jsx)(ne.Z,{value:L,style:{fontSize:"0.8rem",fontWeight:900}})})]})]}),(!(a!=null&&a.passphrase)||P)&&(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsxs)("div",{className:t().codeInput,children:[(0,l.jsxs)("div",{className:t().verifyForm,children:[(0,l.jsx)("span",{className:(s==null?void 0:s.slice(0))&&!(s!=null&&s.slice(1,5))&&t().highLight,children:s==null?void 0:s.slice(0,1).replace(/[^]/,"\u2731")}),(0,l.jsx)("span",{className:(s==null?void 0:s.slice(1))&&!(s!=null&&s.slice(2,5))&&t().highLight,children:s==null?void 0:s.slice(1,2).replace(/[^]/,"\u2731")}),(0,l.jsx)("span",{className:(s==null?void 0:s.slice(2,3))&&!(s!=null&&s.slice(3,5))&&t().highLight,children:s==null?void 0:s.slice(2,3).replace(/[^]/,"\u2731")}),(0,l.jsx)("span",{className:(s==null?void 0:s.slice(3,4))&&!(s!=null&&s.slice(4,5))&&t().highLight,children:s==null?void 0:s.slice(3,4).replace(/[^]/,"\u2731")}),(0,l.jsx)("span",{className:(s==null?void 0:s.slice(4,5))&&!(s!=null&&s.slice(5))&&t().highLight,children:s==null?void 0:s.slice(4,5).replace(/[^]/,"\u2731")}),(0,l.jsx)("span",{className:(s==null?void 0:s.slice(5))&&t().highLight,children:s==null?void 0:s.slice(5).replace(/[^]/,"\u2731")})]}),(0,l.jsx)(M.Z.Password,{autoFocus:!0,autoComplete:"new-password",size:"large",className:t().verifyInput,onChange:W,value:s,disabled:Q,maxLength:6,visibilityToggle:!1})]})})]})};v.Z=q},3548:function(m,v,e){"use strict";var B=e(67294),f=e(31639),R=e.n(f),M=e(96534),K=e(85893),o=function(b){var D=b.value,j=b.style;return(0,K.jsxs)("div",{className:R().ad3,style:j,children:[D?(0,M.MP)(D):"--",(0,K.jsx)("span",{className:R().unit,children:"\xA0$AD3"})]})};v.Z=o},70279:function(m,v,e){"use strict";e.r(v);var B=e(20228),f=e(11382),R=e(74379),M=e(38648),K=e(3182),o=e(2824),F=e(19273),b=e(94043),D=e.n(b),j=e(69764),y=e(46656),Y=e(51625),$=e(28986),V=e(61715),O=e(32689),H=e(50671),d=e(67294),p=e(43581),T=e(51615),U=e(55248),J=e.n(U),t=e(85893);function ne(re){(0,F.Z)(re);var ie=(0,d.useState)(!1),w=(0,o.Z)(ie,2),oe=w[0],l=w[1],de=(0,d.useState)(""),q=(0,o.Z)(de,2),ue=q[0],I=q[1],A=(0,p.tT)("currentUser"),h=A.wallet,s=(0,p.tT)("apiWs"),S=(0,p.YB)(),k=(0,T.UO)(),P=k.adId,ee=k.nftId,G=(0,d.useState)(),z=(0,o.Z)(G,2),g=z[0],a=z[1],ce=(0,d.useState)(),se=(0,o.Z)(ce,2),ae=se[0],te=se[1],Q=(0,d.useState)(!1),Z=(0,o.Z)(Q,2),le=Z[0],_e=Z[1],L=function(){window.opener.postMessage("".concat($.vs.AD_CLAIMED,":").concat(P),"*"),window.close()};(0,d.useEffect)(function(){le&&(ae?g&&(g.tag&&g.score&&(0,O.gd)(P,h.did,{tag:g.tag,score:g.score}),g.link&&window.open(decodeURIComponent(g.link)),L()):L())},[le,ae,g]);var ve=function(){var W=(0,K.Z)(D().mark(function E(N){var u,c,n,x,r,X;return D().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,_.next=3,s==null?void 0:s.query.ad.metadata(N);case 3:if(_.t1=u=_.sent,_.t0=_.t1===null,_.t0){_.next=7;break}_.t0=u===void 0;case 7:if(!_.t0){_.next=11;break}_.t2=void 0,_.next=12;break;case 11:_.t2=u.toHuman();case 12:return n=_.t2,x=n==null||(c=n.metadata)===null||c===void 0?void 0:c.substring(7),_.next=16,fetch(Y.Z.ipfs.endpoint+x);case 16:return r=_.sent,_.next=19,r.json();case 19:X=_.sent,a(X.instructions[0]),_.next=26;break;case 23:_.prev=23,_.t3=_.catch(0),a({});case 26:case"end":return _.stop()}},E,null,[[0,23]])}));return function(N){return W.apply(this,arguments)}}();(0,d.useEffect)(function(){P&&s&&ve(P)},[P,s]),(0,d.useEffect)(function(){var W=(0,H.Y)(),E=W.redirect;E&&te(E)},[]),(0,d.useEffect)(function(){s&&h&&l(!0)},[s,h]);var C=function(){var W=(0,K.Z)(D().mark(function E(N,u){return D().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(h!=null&&h.keystore){n.next=3;break}return M.default.error({key:"accessDenied",message:S.formatMessage({id:"error.accessDenied"}),duration:null}),n.abrupt("return");case 3:return n.prev=3,n.next=6,(0,V.HS)(P,ee,null,null,ue,h.keystore,N,u);case 6:M.default.success({message:"Claim Token Success"}),_e(!0),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(3),console.log(n.t0),M.default.error({message:"Claim Ad Token Error",description:"".concat(n.t0)});case 14:case"end":return n.stop()}},E,null,[[3,10]])}));return function(N,u){return W.apply(this,arguments)}}();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Z,{visable:!0,title:"Claim your token",content:(0,t.jsx)("div",{className:J().container,children:(0,t.jsx)(f.Z,{})}),footer:null,close:function(){window.close()}}),(0,t.jsx)(y.Z,{visable:oe,setVisable:l,passphrase:ue,setPassphrase:I,directSubmit:!0,func:C})]})}v.default=ne},50671:function(m,v,e){"use strict";e.d(v,{Y:function(){return M}});var B=e(11849),f=e(80129),R=e.n(f),M=function(){try{var o=new URL(window.location.href);return(0,B.Z)((0,B.Z)({},R().parse(o.search.substring(1))),R().parse(o.hash.substring(1)))}catch(F){return console.log("Parse url params error",F),{}}}}}]);
